<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUD Modal System</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-6xl mx-auto">
        <div class="bg-white rounded-lg shadow-lg p-6">
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-3xl font-bold text-gray-800">Product Management</h1>
                <button onclick="openCreateModal()" class="bg-[#36BBA7] text-white px-6 py-2 rounded-lg hover:bg-[#2da089] transition-colors">
                    + Add Product
                </button>
            </div>

            <!-- Products Table -->
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ID</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Name</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Price</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Stock</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="productTableBody" class="bg-white divide-y divide-gray-200">
                        <!-- Products will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- CREATE/EDIT Modal -->
    <div id="crudModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md mx-4">
            <!-- Modal Header -->
            <div class="flex justify-between items-center border-b px-6 py-4">
                <h2 id="modalTitle" class="text-xl font-bold text-gray-800">Add Product</h2>
                <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <!-- Modal Body -->
            <form id="productForm" class="p-6">
                <input type="hidden" id="productId">
                
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="productName">
                        Product Name
                    </label>
                    <input type="text" id="productName" required
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#36BBA7]"
                        placeholder="Enter product name">
                </div>

                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="productPrice">
                        Price
                    </label>
                    <input type="number" id="productPrice" required step="0.01"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#36BBA7]"
                        placeholder="Enter price">
                </div>

                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="productStock">
                        Stock Quantity
                    </label>
                    <input type="number" id="productStock" required
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#36BBA7]"
                        placeholder="Enter stock quantity">
                </div>

                <!-- Modal Footer -->
                <div class="flex justify-end gap-3">
                    <button type="button" onclick="closeModal()"
                        class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                        Cancel
                    </button>
                    <button type="submit"
                        class="px-4 py-2 bg-[#36BBA7] text-white rounded-lg hover:bg-[#2da089] transition-colors">
                        Save
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- DELETE Confirmation Modal -->
    <div id="deleteModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md mx-4">
            <div class="p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">Confirm Delete</h3>
                <p class="text-gray-600 mb-6">Are you sure you want to delete this product? This action cannot be undone.</p>
                
                <div class="flex justify-end gap-3">
                    <button onclick="closeDeleteModal()"
                        class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                        Cancel
                    </button>
                    <button onclick="confirmDelete()"
                        class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                        Delete
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample data
        let products = [
            { id: 1, name: 'Laptop', price: 999.99, stock: 15 },
            { id: 2, name: 'Mouse', price: 29.99, stock: 50 },
            { id: 3, name: 'Keyboard', price: 79.99, stock: 30 }
        ];
        let currentEditId = null;
        let deleteId = null;

        // Initialize
        renderProducts();

        // RENDER products to table
        function renderProducts() {
            const tbody = document.getElementById('productTableBody');
            tbody.innerHTML = '';
            
            products.forEach(product => {
                const row = `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 text-sm text-gray-900">${product.id}</td>
                        <td class="px-6 py-4 text-sm text-gray-900">${product.name}</td>
                        <td class="px-6 py-4 text-sm text-gray-900">$${product.price.toFixed(2)}</td>
                        <td class="px-6 py-4 text-sm text-gray-900">${product.stock}</td>
                        <td class="px-6 py-4 text-sm">
                            <button onclick="openViewModal(${product.id})" 
                                class="text-blue-500 hover:text-blue-700 mr-3">View</button>
                            <button onclick="openEditModal(${product.id})" 
                                class="text-green-500 hover:text-green-700 mr-3">Edit</button>
                            <button onclick="openDeleteModal(${product.id})" 
                                class="text-red-500 hover:text-red-700">Delete</button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        // CREATE - Open modal for new product
        function openCreateModal() {
            currentEditId = null;
            document.getElementById('modalTitle').textContent = 'Add Product';
            document.getElementById('productForm').reset();
            document.getElementById('productId').value = '';
            document.getElementById('crudModal').classList.remove('hidden');
        }

        // READ - View product details
        function openViewModal(id) {
            const product = products.find(p => p.id === id);
            if (product) {
                alert(`Product Details:\n\nID: ${product.id}\nName: ${product.name}\nPrice: $${product.price}\nStock: ${product.stock}`);
                // You can create a separate view modal if needed
            }
        }

        // UPDATE - Open modal for editing
        function openEditModal(id) {
            currentEditId = id;
            const product = products.find(p => p.id === id);
            
            if (product) {
                document.getElementById('modalTitle').textContent = 'Edit Product';
                document.getElementById('productId').value = product.id;
                document.getElementById('productName').value = product.name;
                document.getElementById('productPrice').value = product.price;
                document.getElementById('productStock').value = product.stock;
                document.getElementById('crudModal').classList.remove('hidden');
            }
        }

        // DELETE - Open delete confirmation
        function openDeleteModal(id) {
            deleteId = id;
            document.getElementById('deleteModal').classList.remove('hidden');
        }

        // Close CRUD modal
        function closeModal() {
            document.getElementById('crudModal').classList.add('hidden');
            document.getElementById('productForm').reset();
            currentEditId = null;
        }

        // Close delete modal
        function closeDeleteModal() {
            document.getElementById('deleteModal').classList.add('hidden');
            deleteId = null;
        }

        // Confirm delete
        function confirmDelete() {
            products = products.filter(p => p.id !== deleteId);
            renderProducts();
            closeDeleteModal();
        }

        // Handle form submission (CREATE or UPDATE)
        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('productName').value;
            const price = parseFloat(document.getElementById('productPrice').value);
            const stock = parseInt(document.getElementById('productStock').value);

            if (currentEditId) {
                // UPDATE existing product
                const index = products.findIndex(p => p.id === currentEditId);
                if (index !== -1) {
                    products[index] = { id: currentEditId, name, price, stock };
                }
            } else {
                // CREATE new product
                const newId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
                products.push({ id: newId, name, price, stock });
            }

            renderProducts();
            closeModal();
        });

        // Close modal when clicking outside
        document.getElementById('crudModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });

        document.getElementById('deleteModal').addEventListener('click', function(e) {
            if (e.target === this) closeDeleteModal();
        });
    </script>
</body>
</html>